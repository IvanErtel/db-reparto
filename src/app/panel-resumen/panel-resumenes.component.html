<div class="page">
  <div class="wrap">
    <div class="header">
      <div class="title">
        <span class="icon">ğŸ“Š</span>
        <h1>ResÃºmenes</h1>
      </div>

      <input
        class="search"
        type="text"
        placeholder="Buscar por ruta o fecha (YYYY-MM-DD)"
        [ngModel]="filtro()"
        (ngModelChange)="filtro.set($event)"
      />
    </div>

    <div *ngIf="filtrados().length === 0" class="empty">
      No hay resÃºmenes todavÃ­a.
    </div>

    <div class="list" *ngIf="filtrados().length > 0">
      <div class="card" *ngFor="let r of filtrados()">
        <div class="top">
          <div class="meta">
            <div class="fecha">{{ r.fecha }}</div>
            <div class="ruta">{{ r.rutaNombre }}</div>
          </div>

          <div class="top-actions">
            <button
              class="btn ghost btn-mini"
              type="button"
              (click)="verDetalle(r.id)"
            >
              ğŸ‘ï¸ Ver
            </button>

            <button
              class="btn danger btn-mini"
              type="button"
              (click)="abrirEliminar(r)"
            >
              ğŸ—‘ï¸ Eliminar
            </button>
          </div>
        </div>

        <div class="stats">
          <span class="pill">âœ… {{ r.entregados?.length || 0 }}</span>
          <span class="pill">â­ {{ r.salteados?.length || 0 }}</span>
          <span class="pill">â± {{ duracionMin(r.inicio, r.fin) }} min</span>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- âœ… Confirm moderno (bottom-sheet) -->
<div class="backdrop" *ngIf="confirmOpen()" (click)="cerrarEliminar()">
  <div class="sheet" (click)="$event.stopPropagation()">
    <div class="sheetTitle">Eliminar resumen</div>

    <div class="sheetText" *ngIf="pendiente() as r">
      Â¿Eliminar el resumen <strong>{{ r.fecha }}</strong> â€”
      <strong>{{ r.rutaNombre }}</strong
      >?
      <div class="muted">Esta acciÃ³n no se puede deshacer.</div>
    </div>

    <div class="sheetActions">
      <button class="btn ghost" type="button" (click)="cerrarEliminar()">
        Cancelar
      </button>
      <button
        class="btn peligro btn-mini"
        type="button"
        (click)="confirmarEliminar()"
      >
        Eliminar
      </button>
    </div>
  </div>
</div>
