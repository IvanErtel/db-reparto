<div class="reparto" *ngIf="!resumenFinal">

  <button class="btn-volver" (click)="volver()">â¬… Volver</button>
<div class="busqueda-reparto">

<input
  type="text"
  placeholder="Buscar cliente o direcciÃ³nâ€¦"
  [ngModel]="busqueda()"
  (ngModelChange)="busqueda.set($event)">

  <div *ngIf="busqueda"
       class="overlay-busqueda">

    <div *ngIf="resultadosBusqueda().length; else sinResultados"
         class="resultados-busqueda">

      <div class="resultado"
           *ngFor="let r of resultadosBusqueda()"
           (click)="busqueda.set('')">

        <strong>{{ r.cliente }}</strong>
        <div class="mini-dir">{{ r.direccion }}</div>
        <div class="mini-diarios">ğŸ“° {{ r.cantidadDiarios }} diarios</div>
      </div>

    </div>

    <ng-template #sinResultados>
      <div class="sin-resultados">
        No se encontraron resultados
      </div>
    </ng-template>

  </div>

</div>

  <!-- RESUMEN DEL DÃA -->
  <div class="resumen-simple" *ngIf="ruta() as r">
    <p class="mensaje-animo">
  ğŸ’ª Vamos, reparto en marcha
</p>

    <div class="linea1">
      <strong>{{ r.nombrePersonalizado }}</strong>
      <span class="fecha">{{ diaSemana }} {{ fechaHoy }}</span>
    </div>

    <div class="linea2">
      <span>{{ indiceActual() + 1 }} / {{ direcciones().length }}</span>
      <span class="punto">â€¢</span>
      <!-- FIX â†’ quitar [Computed] -->
      <span>{{ totalDiariosHoy() }} diarios</span>
    </div>

    <div class="info-reparto">
  <div>ğŸ“ Direcciones del dÃ­a: <strong>{{ totalHoy() }}</strong></div>
  <div>â³ Restantes: <strong>{{ restantes() }}</strong></div>
</div>

  </div>

 <!-- DIRECCIÃ“N ACTUAL -->
<div
  class="card-principal"
  *ngIf="!resumenFinal && actual() as d"
  [class.anim-ok]="animando"
>

  <h2>{{ d.cliente }}</h2>

  <p class="diarios-reparto">
    ğŸ“° {{ d.cantidadDiarios }} diarios
  </p>

  <p><strong>DirecciÃ³n:</strong> {{ d.direccion }}</p>

  <p *ngIf="d.notas">
    <strong>Notas:</strong><br>
    {{ d.notas }}
  </p>

  <button class="btn-maps" (click)="abrirMaps()">
    ğŸ“ Abrir en Google Maps
  </button>

  <!-- ACCIONES -->
 <div class="acciones-reparto">

  <!-- ACCIÃ“N PRINCIPAL -->
  <button class="btn-primario btn-entregar" (click)="entregar()" [disabled]="resumenFinal">
    âœ” Entregado
  </button>

  <!-- ACCIONES SECUNDARIAS -->
  <div class="fila-secundaria">
    <button class="btn-secundario"
            (click)="anterior()"
            [disabled]="indiceActual() === 0">
      â¬… Anterior
    </button>

    <button class="btn-secundario" (click)="saltar()" [disabled]="resumenFinal">
      â­ Saltar
    </button>
  </div>

</div>


</div>

  <!-- SIGUIENTES DIRECCIONES -->
  <h3 class="tit-siguientes">PrÃ³ximas entregas:</h3>

  <div class="lista-siguientes">
    <div class="preview-card" *ngFor="let s of siguientes()">
      <strong>{{ s.cliente }}</strong>
      <div class="mini-dir">{{ s.direccion }}</div>
    </div>
  </div>

  <button class="btn-reiniciar" (click)="reiniciarReparto()">
    Reiniciar reparto
  </button>

</div>

<app-resumen-reparto
  *ngIf="resumenFinal"
  [resumen]="resumenFinal"
  (cerrarResumen)="cerrarResumen()">
</app-resumen-reparto>

