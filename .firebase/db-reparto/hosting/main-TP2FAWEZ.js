import{$ as g,A as b,Aa as jt,B as Q,Ba as Bt,C as ct,Ca as Lt,D as $,Da as Gt,E as fe,Ea as Ut,F as d,Fa as Ht,G as St,Ga as zt,H as _e,Ha as qt,I as u,Ia as Zt,J as M,Ja as Kt,K as Pe,Ka as Jt,L as S,La as Xt,M as N,Ma as R,N as O,O as xt,P as At,Q as ve,R as It,S as y,T as s,U as a,V as Ne,W as H,X as z,Y as ee,Z as f,_ as Re,a as A,aa as Ft,b as T,ba as l,c as Ie,ca as te,d as oe,da as P,e as bt,f as F,fa as p,g as Dt,ga as h,h as B,ha as m,i as lt,ia as q,j as ae,ja as ke,k as ge,ka as Te,l as L,la as ut,m as Mt,ma as Ot,n as G,na as pt,o as se,oa as We,p as Fe,pa as le,q as U,qa as I,r as Y,ra as Pt,s as V,sa as de,t as wt,ta as Nt,u as _,ua as x,v,va as Rt,w as dt,wa as kt,x as Et,xa as Tt,y as Oe,ya as Wt,z as Vt,za as je}from"./chunk-PWZXVXB4.js";function Sn(n,t){n&1&&(s(0,"div"),l(1,"Cargando rutas..."),a())}function xn(n,t){if(n&1){let e=ee();s(0,"li",4),f("click",function(){let r=_(e).$implicit,o=g(2);return v(o.abrirRuta(r.id))}),s(1,"strong"),l(2),a(),s(3,"span",5),l(4),a()()}if(n&2){let e=t.$implicit;d(2),te(e.nombrePersonalizado),d(2),P("(",e.nombreBase,")")}}function An(n,t){if(n&1&&(s(0,"ul"),O(1,xn,5,2,"li",3),a()),n&2){let e=g();d(),y("ngForOf",e.rutas())}}function In(n,t){n&1&&(s(0,"p"),l(1," No tienes rutas creadas todav\xEDa. "),a())}var Be=class n{constructor(t,e){this.rutasService=t;this.router=e}rutas=b([]);cargando=b(!0);async ngOnInit(){console.log("ListComponent: ngOnInit");try{let t=await this.rutasService.obtenerMisRutas();console.log("ListComponent: rutas cargadas",t),this.rutas.set(t)}catch(t){console.error("Error cargando rutas",t)}finally{this.cargando.set(!1)}}crearNuevaRuta(){this.router.navigate(["/rutas/crear"])}abrirRuta(t){this.router.navigate(["/rutas",t])}static \u0275fac=function(e){return new(e||n)(u(R),u(x))};static \u0275cmp=M({type:n,selectors:[["app-list-rutas"]],decls:8,vars:3,consts:[[1,"lista-rutas"],[1,"btn-crear",3,"click"],[4,"ngIf"],[3,"click",4,"ngFor","ngForOf"],[3,"click"],[1,"base"]],template:function(e,i){e&1&&(s(0,"div",0)(1,"h1"),l(2,"Mis rutas"),a(),s(3,"button",1),f("click",function(){return i.crearNuevaRuta()}),l(4," \u2795 Crear nueva ruta "),a(),O(5,Sn,2,0,"div",2)(6,An,2,1,"ul",2)(7,In,2,0,"p",2),a()),e&2&&(d(5),y("ngIf",i.cargando()),d(),y("ngIf",!i.cargando()&&i.rutas().length>0),d(),y("ngIf",!i.cargando()&&i.rutas().length===0))},dependencies:[I,We,le],styles:[".lista-rutas[_ngcontent-%COMP%]{max-width:500px;margin:0 auto;padding:20px}ul[_ngcontent-%COMP%]{padding:0;list-style:none}li[_ngcontent-%COMP%]{padding:12px;margin:8px 0;background:#f4f4f4;border-radius:8px;cursor:pointer;display:flex;justify-content:space-between}li[_ngcontent-%COMP%]:hover{background:#e8e8e8}.btn-crear[_ngcontent-%COMP%]{margin-bottom:16px;padding:10px 14px;background:#3498db;color:#fff;cursor:pointer;border-radius:6px}"],changeDetection:0})};var Z=class n{constructor(t,e,i){this.auth=t;this.firestore=e;this.router=i;this.currentUser$=Bt(this.auth)}currentUser$;async loginWithGoogle(){try{let t=new Wt,i=(await Gt(this.auth,t)).user.email;if(!i){await this.logout(),alert("No se encontr\xF3 email en la cuenta.");return}if(!await this.isAllowedUser(i)){await this.logout(),alert("Tu usuario no est\xE1 autorizado.");return}this.router.navigate(["/rutas"])}catch(t){console.error("Error en login:",t)}}async isAllowedUser(t){let e=qt(this.firestore,"allowed_users"),i=Jt(e,Xt("email","==",t));return!(await Zt(i)).empty}async logout(){await Ut(this.auth),this.router.navigate(["/login"])}static \u0275fac=function(e){return new(e||n)(Y(je),Y(Ht),Y(x))};static \u0275prov=se({token:n,factory:n.\u0275fac,providedIn:"root"})};var Ge=class n{constructor(t){this.auth=t}logout(){this.auth.logout()}static \u0275fac=function(e){return new(e||n)(u(Z))};static \u0275cmp=M({type:n,selectors:[["app-dashboard"]],decls:6,vars:0,consts:[[3,"click"]],template:function(e,i){e&1&&(H(0,"h1"),l(1,"Bienvenido al Panel"),z(),H(2,"p"),l(3,"Acceso permitido solo a usuarios autorizados."),z(),H(4,"button",0),Re("click",function(){return i.logout()}),l(5,"Cerrar sesi\xF3n"),z())},encapsulation:2})};var ie=()=>{let n=V(Z),t=V(x);return n.currentUser$.pipe(F(e=>e?!0:(t.navigate(["/login"]),!1)))};var Ue=class n{constructor(t){this.auth=t}loginGoogle(){this.auth.loginWithGoogle()}static \u0275fac=function(e){return new(e||n)(u(Z))};static \u0275cmp=M({type:n,selectors:[["app-login"]],decls:7,vars:0,consts:[[1,"login-container"],[1,"google-btn",3,"click"]],template:function(e,i){e&1&&(H(0,"div",0)(1,"h1"),l(2,"DB Reparto"),z(),H(3,"h2"),l(4,"Iniciar sesi\xF3n"),z(),H(5,"button",1),Re("click",function(){return i.loginGoogle()}),l(6," Iniciar con Google "),z()())},dependencies:[I],styles:[".login-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;min-height:100vh;gap:16px;font-family:system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,sans-serif}.google-btn[_ngcontent-%COMP%]{padding:10px 20px;font-size:16px;background-color:#4285f4;color:#fff;border:none;border-radius:6px;cursor:pointer}"]})};var dn=(()=>{class n{_renderer;_elementRef;onChange=e=>{};onTouched=()=>{};constructor(e,i){this._renderer=e,this._elementRef=i}setProperty(e,i){this._renderer.setProperty(this._elementRef.nativeElement,e,i)}registerOnTouched(e){this.onTouched=e}registerOnChange(e){this.onChange=e}setDisabledState(e){this.setProperty("disabled",e)}static \u0275fac=function(i){return new(i||n)(u(_e),u(fe))};static \u0275dir=S({type:n})}return n})(),Ee=(()=>{class n extends dn{static \u0275fac=(()=>{let e;return function(r){return(e||(e=$(n)))(r||n)}})();static \u0275dir=S({type:n,features:[N]})}return n})(),pe=new U(""),On={provide:pe,useExisting:G(()=>Ve),multi:!0},Ve=(()=>{class n extends Ee{writeValue(e){this.setProperty("checked",e)}static \u0275fac=(()=>{let e;return function(r){return(e||(e=$(n)))(r||n)}})();static \u0275dir=S({type:n,selectors:[["input","type","checkbox","formControlName",""],["input","type","checkbox","formControl",""],["input","type","checkbox","ngModel",""]],hostBindings:function(i,r){i&1&&f("change",function(c){return r.onChange(c.target.checked)})("blur",function(){return r.onTouched()})},standalone:!1,features:[q([On]),N]})}return n})(),Pn={provide:pe,useExisting:G(()=>K),multi:!0};function Nn(){let n=pt()?pt().getUserAgent():"";return/android (\d+)/.test(n.toLowerCase())}var Rn=new U(""),K=(()=>{class n extends dn{_compositionMode;_composing=!1;constructor(e,i,r){super(e,i),this._compositionMode=r,this._compositionMode==null&&(this._compositionMode=!Nn())}writeValue(e){let i=e??"";this.setProperty("value",i)}_handleInput(e){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(e)}_compositionStart(){this._composing=!0}_compositionEnd(e){this._composing=!1,this._compositionMode&&this.onChange(e)}static \u0275fac=function(i){return new(i||n)(u(_e),u(fe),u(Rn,8))};static \u0275dir=S({type:n,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(i,r){i&1&&f("input",function(c){return r._handleInput(c.target.value)})("blur",function(){return r.onTouched()})("compositionstart",function(){return r._compositionStart()})("compositionend",function(c){return r._compositionEnd(c.target.value)})},standalone:!1,features:[q([Pn]),N]})}return n})();var cn=new U(""),kn=new U("");function Tn(n){return t=>{if(t.value==null||n==null)return null;let e=parseFloat(t.value);return!isNaN(e)&&e<n?{min:{min:n,actual:t.value}}:null}}function $t(n){return null}function un(n){return n!=null}function pn(n){return xt(n)?bt(n):n}function hn(n){let t={};return n.forEach(e=>{t=e!=null?A(A({},t),e):t}),Object.keys(t).length===0?null:t}function mn(n,t){return t.map(e=>e(n))}function Wn(n){return!n.validate}function gn(n){return n.map(t=>Wn(t)?t:e=>t.validate(e))}function jn(n){if(!n)return null;let t=n.filter(un);return t.length==0?null:function(e){return hn(mn(e,t))}}function fn(n){return n!=null?jn(gn(n)):null}function Bn(n){if(!n)return null;let t=n.filter(un);return t.length==0?null:function(e){let i=mn(e,t).map(pn);return Dt(i).pipe(F(hn))}}function _n(n){return n!=null?Bn(gn(n)):null}function en(n,t){return n===null?[t]:Array.isArray(n)?[...n,t]:[n,t]}function Ln(n){return n._rawValidators}function Gn(n){return n._rawAsyncValidators}function ht(n){return n?Array.isArray(n)?n:[n]:[]}function ze(n,t){return Array.isArray(n)?n.includes(t):n===t}function tn(n,t){let e=ht(t);return ht(n).forEach(r=>{ze(e,r)||e.push(r)}),e}function nn(n,t){return ht(t).filter(e=>!ze(n,e))}var qe=class{get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_composedValidatorFn;_composedAsyncValidatorFn;_rawValidators=[];_rawAsyncValidators=[];_setValidators(t){this._rawValidators=t||[],this._composedValidatorFn=fn(this._rawValidators)}_setAsyncValidators(t){this._rawAsyncValidators=t||[],this._composedAsyncValidatorFn=_n(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_onDestroyCallbacks=[];_registerOnDestroy(t){this._onDestroyCallbacks.push(t)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(t=>t()),this._onDestroyCallbacks=[]}reset(t=void 0){this.control&&this.control.reset(t)}hasError(t,e){return this.control?this.control.hasError(t,e):!1}getError(t,e){return this.control?this.control.getError(t,e):null}},mt=class extends qe{name;get formDirective(){return null}get path(){return null}},we=class extends qe{_parent=null;name=null;valueAccessor=null},gt=class{_cd;constructor(t){this._cd=t}get isTouched(){return this._cd?.control?._touched?.(),!!this._cd?.control?.touched}get isUntouched(){return!!this._cd?.control?.untouched}get isPristine(){return this._cd?.control?._pristine?.(),!!this._cd?.control?.pristine}get isDirty(){return!!this._cd?.control?.dirty}get isValid(){return this._cd?.control?._status?.(),!!this._cd?.control?.valid}get isInvalid(){return!!this._cd?.control?.invalid}get isPending(){return!!this._cd?.control?.pending}get isSubmitted(){return this._cd?._submitted?.(),!!this._cd?.submitted}};var J=(()=>{class n extends gt{constructor(e){super(e)}static \u0275fac=function(i){return new(i||n)(u(we,2))};static \u0275dir=S({type:n,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(i,r){i&2&&Ft("ng-untouched",r.isUntouched)("ng-touched",r.isTouched)("ng-pristine",r.isPristine)("ng-dirty",r.isDirty)("ng-valid",r.isValid)("ng-invalid",r.isInvalid)("ng-pending",r.isPending)},standalone:!1,features:[N]})}return n})();var Ce="VALID",He="INVALID",ce="PENDING",be="DISABLED",re=class{},Ze=class extends re{value;source;constructor(t,e){super(),this.value=t,this.source=e}},De=class extends re{pristine;source;constructor(t,e){super(),this.pristine=t,this.source=e}},Me=class extends re{touched;source;constructor(t,e){super(),this.touched=t,this.source=e}},ue=class extends re{status;source;constructor(t,e){super(),this.status=t,this.source=e}};var ft=class extends re{source;constructor(t){super(),this.source=t}};function Un(n){return(Ke(n)?n.validators:n)||null}function Hn(n){return Array.isArray(n)?fn(n):n||null}function zn(n,t){return(Ke(t)?t.asyncValidators:n)||null}function qn(n){return Array.isArray(n)?_n(n):n||null}function Ke(n){return n!=null&&!Array.isArray(n)&&typeof n=="object"}var _t=class{_pendingDirty=!1;_hasOwnPendingAsyncValidator=null;_pendingTouched=!1;_onCollectionChange=()=>{};_updateOn;_parent=null;_asyncValidationSubscription;_composedValidatorFn;_composedAsyncValidatorFn;_rawValidators;_rawAsyncValidators;value;constructor(t,e){this._assignValidators(t),this._assignAsyncValidators(e)}get validator(){return this._composedValidatorFn}set validator(t){this._rawValidators=this._composedValidatorFn=t}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(t){this._rawAsyncValidators=this._composedAsyncValidatorFn=t}get parent(){return this._parent}get status(){return Q(this.statusReactive)}set status(t){Q(()=>this.statusReactive.set(t))}_status=ke(()=>this.statusReactive());statusReactive=b(void 0);get valid(){return this.status===Ce}get invalid(){return this.status===He}get pending(){return this.status==ce}get disabled(){return this.status===be}get enabled(){return this.status!==be}errors;get pristine(){return Q(this.pristineReactive)}set pristine(t){Q(()=>this.pristineReactive.set(t))}_pristine=ke(()=>this.pristineReactive());pristineReactive=b(!0);get dirty(){return!this.pristine}get touched(){return Q(this.touchedReactive)}set touched(t){Q(()=>this.touchedReactive.set(t))}_touched=ke(()=>this.touchedReactive());touchedReactive=b(!1);get untouched(){return!this.touched}_events=new oe;events=this._events.asObservable();valueChanges;statusChanges;get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(t){this._assignValidators(t)}setAsyncValidators(t){this._assignAsyncValidators(t)}addValidators(t){this.setValidators(tn(t,this._rawValidators))}addAsyncValidators(t){this.setAsyncValidators(tn(t,this._rawAsyncValidators))}removeValidators(t){this.setValidators(nn(t,this._rawValidators))}removeAsyncValidators(t){this.setAsyncValidators(nn(t,this._rawAsyncValidators))}hasValidator(t){return ze(this._rawValidators,t)}hasAsyncValidator(t){return ze(this._rawAsyncValidators,t)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(t={}){let e=this.touched===!1;this.touched=!0;let i=t.sourceControl??this;this._parent&&!t.onlySelf&&this._parent.markAsTouched(T(A({},t),{sourceControl:i})),e&&t.emitEvent!==!1&&this._events.next(new Me(!0,i))}markAllAsDirty(t={}){this.markAsDirty({onlySelf:!0,emitEvent:t.emitEvent,sourceControl:this}),this._forEachChild(e=>e.markAllAsDirty(t))}markAllAsTouched(t={}){this.markAsTouched({onlySelf:!0,emitEvent:t.emitEvent,sourceControl:this}),this._forEachChild(e=>e.markAllAsTouched(t))}markAsUntouched(t={}){let e=this.touched===!0;this.touched=!1,this._pendingTouched=!1;let i=t.sourceControl??this;this._forEachChild(r=>{r.markAsUntouched({onlySelf:!0,emitEvent:t.emitEvent,sourceControl:i})}),this._parent&&!t.onlySelf&&this._parent._updateTouched(t,i),e&&t.emitEvent!==!1&&this._events.next(new Me(!1,i))}markAsDirty(t={}){let e=this.pristine===!0;this.pristine=!1;let i=t.sourceControl??this;this._parent&&!t.onlySelf&&this._parent.markAsDirty(T(A({},t),{sourceControl:i})),e&&t.emitEvent!==!1&&this._events.next(new De(!1,i))}markAsPristine(t={}){let e=this.pristine===!1;this.pristine=!0,this._pendingDirty=!1;let i=t.sourceControl??this;this._forEachChild(r=>{r.markAsPristine({onlySelf:!0,emitEvent:t.emitEvent})}),this._parent&&!t.onlySelf&&this._parent._updatePristine(t,i),e&&t.emitEvent!==!1&&this._events.next(new De(!0,i))}markAsPending(t={}){this.status=ce;let e=t.sourceControl??this;t.emitEvent!==!1&&(this._events.next(new ue(this.status,e)),this.statusChanges.emit(this.status)),this._parent&&!t.onlySelf&&this._parent.markAsPending(T(A({},t),{sourceControl:e}))}disable(t={}){let e=this._parentMarkedDirty(t.onlySelf);this.status=be,this.errors=null,this._forEachChild(r=>{r.disable(T(A({},t),{onlySelf:!0}))}),this._updateValue();let i=t.sourceControl??this;t.emitEvent!==!1&&(this._events.next(new Ze(this.value,i)),this._events.next(new ue(this.status,i)),this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors(T(A({},t),{skipPristineCheck:e}),this),this._onDisabledChange.forEach(r=>r(!0))}enable(t={}){let e=this._parentMarkedDirty(t.onlySelf);this.status=Ce,this._forEachChild(i=>{i.enable(T(A({},t),{onlySelf:!0}))}),this.updateValueAndValidity({onlySelf:!0,emitEvent:t.emitEvent}),this._updateAncestors(T(A({},t),{skipPristineCheck:e}),this),this._onDisabledChange.forEach(i=>i(!1))}_updateAncestors(t,e){this._parent&&!t.onlySelf&&(this._parent.updateValueAndValidity(t),t.skipPristineCheck||this._parent._updatePristine({},e),this._parent._updateTouched({},e))}setParent(t){this._parent=t}getRawValue(){return this.value}updateValueAndValidity(t={}){if(this._setInitialStatus(),this._updateValue(),this.enabled){let i=this._cancelExistingSubscription();this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===Ce||this.status===ce)&&this._runAsyncValidator(i,t.emitEvent)}let e=t.sourceControl??this;t.emitEvent!==!1&&(this._events.next(new Ze(this.value,e)),this._events.next(new ue(this.status,e)),this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!t.onlySelf&&this._parent.updateValueAndValidity(T(A({},t),{sourceControl:e}))}_updateTreeValidity(t={emitEvent:!0}){this._forEachChild(e=>e._updateTreeValidity(t)),this.updateValueAndValidity({onlySelf:!0,emitEvent:t.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?be:Ce}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(t,e){if(this.asyncValidator){this.status=ce,this._hasOwnPendingAsyncValidator={emitEvent:e!==!1,shouldHaveEmitted:t!==!1};let i=pn(this.asyncValidator(this));this._asyncValidationSubscription=i.subscribe(r=>{this._hasOwnPendingAsyncValidator=null,this.setErrors(r,{emitEvent:e,shouldHaveEmitted:t})})}}_cancelExistingSubscription(){if(this._asyncValidationSubscription){this._asyncValidationSubscription.unsubscribe();let t=(this._hasOwnPendingAsyncValidator?.emitEvent||this._hasOwnPendingAsyncValidator?.shouldHaveEmitted)??!1;return this._hasOwnPendingAsyncValidator=null,t}return!1}setErrors(t,e={}){this.errors=t,this._updateControlsErrors(e.emitEvent!==!1,this,e.shouldHaveEmitted)}get(t){let e=t;return e==null||(Array.isArray(e)||(e=e.split(".")),e.length===0)?null:e.reduce((i,r)=>i&&i._find(r),this)}getError(t,e){let i=e?this.get(e):this;return i&&i.errors?i.errors[t]:null}hasError(t,e){return!!this.getError(t,e)}get root(){let t=this;for(;t._parent;)t=t._parent;return t}_updateControlsErrors(t,e,i){this.status=this._calculateStatus(),t&&this.statusChanges.emit(this.status),(t||i)&&this._events.next(new ue(this.status,e)),this._parent&&this._parent._updateControlsErrors(t,e,i)}_initObservables(){this.valueChanges=new Oe,this.statusChanges=new Oe}_calculateStatus(){return this._allControlsDisabled()?be:this.errors?He:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(ce)?ce:this._anyControlsHaveStatus(He)?He:Ce}_anyControlsHaveStatus(t){return this._anyControls(e=>e.status===t)}_anyControlsDirty(){return this._anyControls(t=>t.dirty)}_anyControlsTouched(){return this._anyControls(t=>t.touched)}_updatePristine(t,e){let i=!this._anyControlsDirty(),r=this.pristine!==i;this.pristine=i,this._parent&&!t.onlySelf&&this._parent._updatePristine(t,e),r&&this._events.next(new De(this.pristine,e))}_updateTouched(t={},e){this.touched=this._anyControlsTouched(),this._events.next(new Me(this.touched,e)),this._parent&&!t.onlySelf&&this._parent._updateTouched(t,e)}_onDisabledChange=[];_registerOnCollectionChange(t){this._onCollectionChange=t}_setUpdateStrategy(t){Ke(t)&&t.updateOn!=null&&(this._updateOn=t.updateOn)}_parentMarkedDirty(t){let e=this._parent&&this._parent.dirty;return!t&&!!e&&!this._parent._anyControlsDirty()}_find(t){return null}_assignValidators(t){this._rawValidators=Array.isArray(t)?t.slice():t,this._composedValidatorFn=Hn(this._rawValidators)}_assignAsyncValidators(t){this._rawAsyncValidators=Array.isArray(t)?t.slice():t,this._composedAsyncValidatorFn=qn(this._rawAsyncValidators)}};var vn=new U("",{factory:()=>vt}),vt="always";function Zn(n,t){return[...t.path,n]}function Kn(n,t,e=vt){Xn(n,t),t.valueAccessor.writeValue(n.value),(n.disabled||e==="always")&&t.valueAccessor.setDisabledState?.(n.disabled),Yn(n,t),$n(n,t),Qn(n,t),Jn(n,t)}function rn(n,t){n.forEach(e=>{e.registerOnValidatorChange&&e.registerOnValidatorChange(t)})}function Jn(n,t){if(t.valueAccessor.setDisabledState){let e=i=>{t.valueAccessor.setDisabledState(i)};n.registerOnDisabledChange(e),t._registerOnDestroy(()=>{n._unregisterOnDisabledChange(e)})}}function Xn(n,t){let e=Ln(n);t.validator!==null?n.setValidators(en(e,t.validator)):typeof e=="function"&&n.setValidators([e]);let i=Gn(n);t.asyncValidator!==null?n.setAsyncValidators(en(i,t.asyncValidator)):typeof i=="function"&&n.setAsyncValidators([i]);let r=()=>n.updateValueAndValidity();rn(t._rawValidators,r),rn(t._rawAsyncValidators,r)}function Yn(n,t){t.valueAccessor.registerOnChange(e=>{n._pendingValue=e,n._pendingChange=!0,n._pendingDirty=!0,n.updateOn==="change"&&yn(n,t)})}function Qn(n,t){t.valueAccessor.registerOnTouched(()=>{n._pendingTouched=!0,n.updateOn==="blur"&&n._pendingChange&&yn(n,t),n.updateOn!=="submit"&&n.markAsTouched()})}function yn(n,t){n._pendingDirty&&n.markAsDirty(),n.setValue(n._pendingValue,{emitModelToViewChange:!1}),t.viewToModelUpdate(n._pendingValue),n._pendingChange=!1}function $n(n,t){let e=(i,r)=>{t.valueAccessor.writeValue(i),r&&t.viewToModelUpdate(i)};n.registerOnChange(e),t._registerOnDestroy(()=>{n._unregisterOnChange(e)})}function ei(n,t){if(!n.hasOwnProperty("model"))return!1;let e=n.model;return e.isFirstChange()?!0:!Object.is(t,e.currentValue)}function ti(n){return Object.getPrototypeOf(n.constructor)===Ee}function ni(n,t){if(!t)return null;Array.isArray(t);let e,i,r;return t.forEach(o=>{o.constructor===K?e=o:ti(o)?i=o:r=o}),r||i||e||null}function on(n,t){let e=n.indexOf(t);e>-1&&n.splice(e,1)}function an(n){return typeof n=="object"&&n!==null&&Object.keys(n).length===2&&"value"in n&&"disabled"in n}var ii=class extends _t{defaultValue=null;_onChange=[];_pendingValue;_pendingChange=!1;constructor(t=null,e,i){super(Un(e),zn(i,e)),this._applyFormState(t),this._setUpdateStrategy(e),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),Ke(e)&&(e.nonNullable||e.initialValueIsDefault)&&(an(t)?this.defaultValue=t.value:this.defaultValue=t)}setValue(t,e={}){this.value=this._pendingValue=t,this._onChange.length&&e.emitModelToViewChange!==!1&&this._onChange.forEach(i=>i(this.value,e.emitViewToModelChange!==!1)),this.updateValueAndValidity(e)}patchValue(t,e={}){this.setValue(t,e)}reset(t=this.defaultValue,e={}){this._applyFormState(t),this.markAsPristine(e),this.markAsUntouched(e),this.setValue(this.value,e),e.overwriteDefaultValue&&(this.defaultValue=this.value),this._pendingChange=!1,e?.emitEvent!==!1&&this._events.next(new ft(this))}_updateValue(){}_anyControls(t){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(t){this._onChange.push(t)}_unregisterOnChange(t){on(this._onChange,t)}registerOnDisabledChange(t){this._onDisabledChange.push(t)}_unregisterOnDisabledChange(t){on(this._onDisabledChange,t)}_forEachChild(t){}_syncPendingControls(){return this.updateOn==="submit"&&(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),this._pendingChange)?(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),!0):!1}_applyFormState(t){an(t)?(this.value=this._pendingValue=t.value,t.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=t}};var ri={provide:we,useExisting:G(()=>W)},sn=Promise.resolve(),W=(()=>{class n extends we{_changeDetectorRef;callSetDisabledState;control=new ii;static ngAcceptInputType_isDisabled;_registered=!1;viewModel;name="";isDisabled;model;options;update=new Oe;constructor(e,i,r,o,c,C){super(),this._changeDetectorRef=c,this.callSetDisabledState=C,this._parent=e,this._setValidators(i),this._setAsyncValidators(r),this.valueAccessor=ni(this,o)}ngOnChanges(e){if(this._checkForErrors(),!this._registered||"name"in e){if(this._registered&&(this._checkName(),this.formDirective)){let i=e.name.previousValue;this.formDirective.removeControl({name:i,path:this._getPath(i)})}this._setUpControl()}"isDisabled"in e&&this._updateDisabled(e),ei(e,this.viewModel)&&(this._updateValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}get path(){return this._getPath(this.name)}get formDirective(){return this._parent?this._parent.formDirective:null}viewToModelUpdate(e){this.viewModel=e,this.update.emit(e)}_setUpControl(){this._setUpdateStrategy(),this._isStandalone()?this._setUpStandalone():this.formDirective.addControl(this),this._registered=!0}_setUpdateStrategy(){this.options&&this.options.updateOn!=null&&(this.control._updateOn=this.options.updateOn)}_isStandalone(){return!this._parent||!!(this.options&&this.options.standalone)}_setUpStandalone(){Kn(this.control,this,this.callSetDisabledState),this.control.updateValueAndValidity({emitEvent:!1})}_checkForErrors(){this._checkName()}_checkName(){this.options&&this.options.name&&(this.name=this.options.name),!this._isStandalone()&&this.name}_updateValue(e){sn.then(()=>{this.control.setValue(e,{emitViewToModelChange:!1}),this._changeDetectorRef?.markForCheck()})}_updateDisabled(e){let i=e.isDisabled.currentValue,r=i!==0&&Ot(i);sn.then(()=>{r&&!this.control.disabled?this.control.disable():!r&&this.control.disabled&&this.control.enable(),this._changeDetectorRef?.markForCheck()})}_getPath(e){return this._parent?Zn(e,this._parent):[e]}static \u0275fac=function(i){return new(i||n)(u(mt,9),u(cn,10),u(kn,10),u(pe,10),u(ut,8),u(vn,8))};static \u0275dir=S({type:n,selectors:[["","ngModel","",3,"formControlName","",3,"formControl",""]],inputs:{name:"name",isDisabled:[0,"disabled","isDisabled"],model:[0,"ngModel","model"],options:[0,"ngModelOptions","options"]},outputs:{update:"ngModelChange"},exportAs:["ngModel"],standalone:!1,features:[q([ri]),N,ct]})}return n})();var oi={provide:pe,useExisting:G(()=>Se),multi:!0},Se=(()=>{class n extends Ee{writeValue(e){let i=e??"";this.setProperty("value",i)}registerOnChange(e){this.onChange=i=>{e(i==""?null:parseFloat(i))}}static \u0275fac=(()=>{let e;return function(r){return(e||(e=$(n)))(r||n)}})();static \u0275dir=S({type:n,selectors:[["input","type","number","formControlName",""],["input","type","number","formControl",""],["input","type","number","ngModel",""]],hostBindings:function(i,r){i&1&&f("input",function(c){return r.onChange(c.target.value)})("blur",function(){return r.onTouched()})},standalone:!1,features:[q([oi]),N]})}return n})();var ai={provide:pe,useExisting:G(()=>he),multi:!0};function Cn(n,t){return n==null?`${t}`:(t&&typeof t=="object"&&(t="Object"),`${n}: ${t}`.slice(0,50))}function si(n){return n.split(":")[0]}var he=(()=>{class n extends Ee{value;_optionMap=new Map;_idCounter=0;set compareWith(e){this._compareWith=e}_compareWith=Object.is;appRefInjector=V(ve).injector;destroyRef=V(Et);cdr=V(ut);_queuedWrite=!1;_writeValueAfterRender(){this._queuedWrite||this.appRefInjector.destroyed||(this._queuedWrite=!0,St({write:()=>{this.destroyRef.destroyed||(this._queuedWrite=!1,this.writeValue(this.value))}},{injector:this.appRefInjector}))}writeValue(e){this.cdr.markForCheck(),this.value=e;let i=this._getOptionId(e),r=Cn(i,e);this.setProperty("value",r)}registerOnChange(e){this.onChange=i=>{this.value=this._getOptionValue(i),e(this.value)}}_registerOption(){return(this._idCounter++).toString()}_getOptionId(e){for(let i of this._optionMap.keys())if(this._compareWith(this._optionMap.get(i),e))return i;return null}_getOptionValue(e){let i=si(e);return this._optionMap.has(i)?this._optionMap.get(i):e}static \u0275fac=(()=>{let e;return function(r){return(e||(e=$(n)))(r||n)}})();static \u0275dir=S({type:n,selectors:[["select","formControlName","",3,"multiple",""],["select","formControl","",3,"multiple",""],["select","ngModel","",3,"multiple",""]],hostBindings:function(i,r){i&1&&f("change",function(c){return r.onChange(c.target.value)})("blur",function(){return r.onTouched()})},inputs:{compareWith:"compareWith"},standalone:!1,features:[q([ai]),N]})}return n})(),Je=(()=>{class n{_element;_renderer;_select;id;constructor(e,i,r){this._element=e,this._renderer=i,this._select=r,this._select&&(this.id=this._select._registerOption())}set ngValue(e){this._select!=null&&(this._select._optionMap.set(this.id,e),this._setElementValue(Cn(this.id,e)),this._select._writeValueAfterRender())}set value(e){this._setElementValue(e),this._select&&this._select._writeValueAfterRender()}_setElementValue(e){this._renderer.setProperty(this._element.nativeElement,"value",e)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select._writeValueAfterRender())}static \u0275fac=function(i){return new(i||n)(u(fe),u(_e),u(he,9))};static \u0275dir=S({type:n,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"},standalone:!1})}return n})(),li={provide:pe,useExisting:G(()=>bn),multi:!0};function ln(n,t){return n==null?`${t}`:(typeof t=="string"&&(t=`'${t}'`),t&&typeof t=="object"&&(t="Object"),`${n}: ${t}`.slice(0,50))}function di(n){return n.split(":")[0]}var bn=(()=>{class n extends Ee{value;_optionMap=new Map;_idCounter=0;set compareWith(e){this._compareWith=e}_compareWith=Object.is;writeValue(e){this.value=e;let i;if(Array.isArray(e)){let r=e.map(o=>this._getOptionId(o));i=(o,c)=>{o._setSelected(r.indexOf(c.toString())>-1)}}else i=(r,o)=>{r._setSelected(!1)};this._optionMap.forEach(i)}registerOnChange(e){this.onChange=i=>{let r=[],o=i.selectedOptions;if(o!==void 0){let c=o;for(let C=0;C<c.length;C++){let w=c[C],D=this._getOptionValue(w.value);r.push(D)}}else{let c=i.options;for(let C=0;C<c.length;C++){let w=c[C];if(w.selected){let D=this._getOptionValue(w.value);r.push(D)}}}this.value=r,e(r)}}_registerOption(e){let i=(this._idCounter++).toString();return this._optionMap.set(i,e),i}_getOptionId(e){for(let i of this._optionMap.keys())if(this._compareWith(this._optionMap.get(i)._value,e))return i;return null}_getOptionValue(e){let i=di(e);return this._optionMap.has(i)?this._optionMap.get(i)._value:e}static \u0275fac=(()=>{let e;return function(r){return(e||(e=$(n)))(r||n)}})();static \u0275dir=S({type:n,selectors:[["select","multiple","","formControlName",""],["select","multiple","","formControl",""],["select","multiple","","ngModel",""]],hostBindings:function(i,r){i&1&&f("change",function(c){return r.onChange(c.target)})("blur",function(){return r.onTouched()})},inputs:{compareWith:"compareWith"},standalone:!1,features:[q([li]),N]})}return n})(),Xe=(()=>{class n{_element;_renderer;_select;id;_value;constructor(e,i,r){this._element=e,this._renderer=i,this._select=r,this._select&&(this.id=this._select._registerOption(this))}set ngValue(e){this._select!=null&&(this._value=e,this._setElementValue(ln(this.id,e)),this._select.writeValue(this._select.value))}set value(e){this._select?(this._value=e,this._setElementValue(ln(this.id,e)),this._select.writeValue(this._select.value)):this._setElementValue(e)}_setElementValue(e){this._renderer.setProperty(this._element.nativeElement,"value",e)}_setSelected(e){this._renderer.setProperty(this._element.nativeElement,"selected",e)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}static \u0275fac=function(i){return new(i||n)(u(fe),u(_e),u(bn,9))};static \u0275dir=S({type:n,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"},standalone:!1})}return n})();function ci(n){return typeof n=="number"?n:parseFloat(n)}var ui=(()=>{class n{_validator=$t;_onChange;_enabled;ngOnChanges(e){if(this.inputName in e){let i=this.normalizeInput(e[this.inputName].currentValue);this._enabled=this.enabled(i),this._validator=this._enabled?this.createValidator(i):$t,this._onChange&&this._onChange()}}validate(e){return this._validator(e)}registerOnValidatorChange(e){this._onChange=e}enabled(e){return e!=null}static \u0275fac=function(i){return new(i||n)};static \u0275dir=S({type:n,features:[ct]})}return n})();var pi={provide:cn,useExisting:G(()=>xe),multi:!0},xe=(()=>{class n extends ui{min;inputName="min";normalizeInput=e=>ci(e);createValidator=e=>Tn(e);static \u0275fac=(()=>{let e;return function(r){return(e||(e=$(n)))(r||n)}})();static \u0275dir=S({type:n,selectors:[["input","type","number","min","","formControlName",""],["input","type","number","min","","formControl",""],["input","type","number","min","","ngModel",""]],hostVars:1,hostBindings:function(i,r){i&2&&It("min",r._enabled?r.min:null)},inputs:{min:"min"},standalone:!1,features:[q([pi]),N]})}return n})();var hi=(()=>{class n{static \u0275fac=function(i){return new(i||n)};static \u0275mod=Pe({type:n});static \u0275inj=Fe({})}return n})();var X=(()=>{class n{static withConfig(e){return{ngModule:n,providers:[{provide:vn,useValue:e.callSetDisabledState??vt}]}}static \u0275fac=function(i){return new(i||n)};static \u0275mod=Pe({type:n});static \u0275inj=Fe({imports:[hi]})}return n})();var Qe=class n{constructor(t,e){this.rutasService=t;this.router=e}nombreBase="GAMONAL";nombrePersonalizado="";async guardar(){if(!this.nombrePersonalizado.trim()){alert("Debes ingresar un nombre para la ruta.");return}await this.rutasService.crearRuta({nombreBase:this.nombreBase,nombrePersonalizado:this.nombrePersonalizado}),alert("Ruta creada correctamente"),window.location.href="/rutas"}cancelar(){window.location.href="/rutas"}static \u0275fac=function(e){return new(e||n)(u(R),u(x))};static \u0275cmp=M({type:n,selectors:[["app-crear-ruta"]],decls:24,vars:2,consts:[[1,"crear-ruta"],[3,"ngModelChange","ngModel"],["value","GAMONAL"],["value","ESTE"],["value","CENTRO"],["value","OESTE"],["value","SUR"],["type","text","placeholder","Ej: Gamonal Iv\xE1n",3,"ngModelChange","ngModel"],[1,"acciones"],[1,"guardar",3,"click"],[1,"cancelar",3,"click"]],template:function(e,i){e&1&&(s(0,"div",0)(1,"h1"),l(2,"Crear nueva ruta"),a(),s(3,"label"),l(4," Zona base: "),s(5,"select",1),m("ngModelChange",function(o){return h(i.nombreBase,o)||(i.nombreBase=o),o}),s(6,"option",2),l(7,"Gamonal"),a(),s(8,"option",3),l(9,"Este"),a(),s(10,"option",4),l(11,"Centro"),a(),s(12,"option",5),l(13,"Oeste"),a(),s(14,"option",6),l(15,"Sur"),a()()(),s(16,"label"),l(17," Nombre personalizado: "),s(18,"input",7),m("ngModelChange",function(o){return h(i.nombrePersonalizado,o)||(i.nombrePersonalizado=o),o}),a()(),s(19,"div",8)(20,"button",9),f("click",function(){return i.guardar()}),l(21,"Guardar"),a(),s(22,"button",10),f("click",function(){return i.cancelar()}),l(23,"Cancelar"),a()()()),e&2&&(d(5),p("ngModel",i.nombreBase),d(13),p("ngModel",i.nombrePersonalizado))},dependencies:[I,X,Je,Xe,K,he,J,W],styles:[".crear-ruta[_ngcontent-%COMP%]{max-width:500px;margin:20px auto;padding:20px}label[_ngcontent-%COMP%]{display:flex;flex-direction:column;margin:12px 0}input[_ngcontent-%COMP%], select[_ngcontent-%COMP%]{padding:8px;border-radius:6px;border:1px solid #ccc}.acciones[_ngcontent-%COMP%]{display:flex;gap:12px;margin-top:20px}.guardar[_ngcontent-%COMP%]{padding:10px 14px;background:#27ae60;color:#fff;border:none;border-radius:6px;cursor:pointer}.cancelar[_ngcontent-%COMP%]{padding:10px 14px;background:#e74c3c;color:#fff;border:none;border-radius:6px;cursor:pointer}"]})};function mi(n,t){n&1&&(s(0,"div",20),l(1," Cargando direcciones... "),a())}function gi(n,t){if(n&1){let e=ee();s(0,"div",23),f("click",function(){let r=_(e).$implicit,o=g(2);return v(o.abrirDetalle(r))}),s(1,"div",24),l(2),a(),s(3,"div",25),l(4),a(),s(5,"div",26),l(6),a()()}if(n&2){let e=t.$implicit;d(2),te(e.cliente),d(2),P("\u{1F4CD} ",e.direccion),d(2),P("\u{1F4F0} ",e.cantidadDiarios," diarios")}}function fi(n,t){if(n&1&&(s(0,"div",21),O(1,gi,7,3,"div",22),a()),n&2){let e=g();d(),y("ngForOf",e.direcciones())}}function _i(n,t){n&1&&(s(0,"p",27),l(1," Esta ruta todav\xEDa no tiene direcciones. "),a())}function vi(n,t){if(n&1&&(s(0,"p")(1,"strong"),l(2,"Latitud:"),a(),l(3),a()),n&2){let e,i=g(2);d(3),P(" ",(e=i.detalleSeleccionado())==null?null:e.lat,`
`)}}function yi(n,t){if(n&1&&(s(0,"p")(1,"strong"),l(2,"Longitud:"),a(),l(3),a()),n&2){let e,i=g(2);d(3),P(" ",(e=i.detalleSeleccionado())==null?null:e.lng,`
`)}}function Ci(n,t){n&1&&(s(0,"li"),l(1,"Lunes"),a())}function bi(n,t){n&1&&(s(0,"li"),l(1,"Martes"),a())}function Di(n,t){n&1&&(s(0,"li"),l(1,"Mi\xE9rcoles"),a())}function Mi(n,t){n&1&&(s(0,"li"),l(1,"Jueves"),a())}function wi(n,t){n&1&&(s(0,"li"),l(1,"Viernes"),a())}function Ei(n,t){n&1&&(s(0,"li"),l(1,"S\xE1bado"),a())}function Vi(n,t){n&1&&(s(0,"li"),l(1,"Domingo"),a())}function Si(n,t){n&1&&(s(0,"li"),l(1,"Festivos"),a())}function xi(n,t){if(n&1&&(s(0,"p")(1,"strong"),l(2,"Notas:"),a(),Ne(3,"br"),l(4),a()),n&2){let e,i=g(2);d(4),P(" ",(e=i.detalleSeleccionado())==null?null:e.notas," ")}}function Ai(n,t){if(n&1){let e=ee();s(0,"div",28)(1,"div",29)(2,"h2"),l(3),a(),s(4,"p")(5,"strong"),l(6,"Direcci\xF3n:"),a(),l(7),a(),s(8,"p")(9,"strong"),l(10,"Diarios:"),a(),l(11),a(),O(12,vi,4,1,"p",30)(13,yi,4,1,"p",30),s(14,"p")(15,"strong"),l(16,"D\xEDas:"),a()(),s(17,"ul"),O(18,Ci,2,0,"li",30)(19,bi,2,0,"li",30)(20,Di,2,0,"li",30)(21,Mi,2,0,"li",30)(22,wi,2,0,"li",30)(23,Ei,2,0,"li",30)(24,Vi,2,0,"li",30)(25,Si,2,0,"li",30),a(),O(26,xi,5,1,"p",30),s(27,"div",31)(28,"button",32),f("click",function(){_(e);let r=g();return v(r.abrirEnMaps())}),l(29," \u{1F4CD} Ver en Google Maps "),a(),s(30,"button",33),f("click",function(){_(e);let r=g();return v(r.editarDireccion(r.detalleSeleccionado().id))}),l(31," Editar "),a(),s(32,"button",34),f("click",function(){_(e);let r=g();return v(r.cerrarModal())}),l(33," Cerrar "),a()()()()}if(n&2){let e,i,r,o,c,C,w,D,j,rt,ot,at,st,Ct,E=g();d(3),te((e=E.detalleSeleccionado())==null?null:e.cliente),d(4),P(" ",(i=E.detalleSeleccionado())==null?null:i.direccion),d(4),P(" ",(r=E.detalleSeleccionado())==null?null:r.cantidadDiarios),d(),y("ngIf",(o=E.detalleSeleccionado())==null?null:o.lat),d(),y("ngIf",(c=E.detalleSeleccionado())==null?null:c.lng),d(5),y("ngIf",(C=E.detalleSeleccionado())==null||C.dias==null?null:C.dias.lunes),d(),y("ngIf",(w=E.detalleSeleccionado())==null||w.dias==null?null:w.dias.martes),d(),y("ngIf",(D=E.detalleSeleccionado())==null||D.dias==null?null:D.dias.miercoles),d(),y("ngIf",(j=E.detalleSeleccionado())==null||j.dias==null?null:j.dias.jueves),d(),y("ngIf",(rt=E.detalleSeleccionado())==null||rt.dias==null?null:rt.dias.viernes),d(),y("ngIf",(ot=E.detalleSeleccionado())==null||ot.dias==null?null:ot.dias.sabado),d(),y("ngIf",(at=E.detalleSeleccionado())==null||at.dias==null?null:at.dias.domingo),d(),y("ngIf",(st=E.detalleSeleccionado())==null||st.dias==null?null:st.dias.festivos),d(),y("ngIf",(Ct=E.detalleSeleccionado())==null?null:Ct.notas)}}var $e=class n{constructor(t,e,i,r){this.route=t;this.router=e;this.rutasService=i;this.auth=r}rutaId="";ruta=b(null);direcciones=b([]);cargandoRuta=b(!0);cargandoDirecciones=b(!0);diaSeleccionado="todos";todasLasDirecciones=[];detalleSeleccionado=b(null);modalAbierto=b(!1);async ngOnInit(){this.rutaId=this.route.snapshot.params.id,await this.cargarRuta(),await this.cargarDirecciones()}async cargarRuta(){let t=await this.rutasService.obtenerRutaPorId(this.rutaId);this.ruta.set(t),this.cargandoRuta.set(!1)}async cargarDirecciones(){let t=await this.rutasService.obtenerDireccionesOrdenadas(this.rutaId);this.todasLasDirecciones=t,this.direcciones.set(t),this.cargandoDirecciones.set(!1)}abrirDetalle(t){this.detalleSeleccionado.set(t),this.modalAbierto.set(!0)}cerrarModal(){this.modalAbierto.set(!1)}filtrarPorDia(){if(this.diaSeleccionado==="todos"){this.direcciones.set(this.todasLasDirecciones);return}let t=this.todasLasDirecciones.filter(e=>e.dias[this.diaSeleccionado]);this.direcciones.set(t)}volver(){this.router.navigate(["/rutas"])}agregarDireccion(){this.router.navigate(["/rutas",this.rutaId,"agregar"])}editarDireccion(t){this.router.navigate(["/rutas",this.rutaId,"editar",t])}iniciarReparto(){this.router.navigate(["/rutas",this.rutaId,"reparto"])}hayProgresoGuardado(){return localStorage.getItem(`reparto_${this.rutaId}`)!==null}abrirEnMaps(){let t=this.detalleSeleccionado();if(!t)return;if(t.lat&&t.lng){window.open(`https://www.google.com/maps?q=${t.lat},${t.lng}`,"_blank");return}let e=encodeURIComponent(t.direccion);window.open(`https://www.google.com/maps?q=${e}`,"_blank")}static \u0275fac=function(e){return new(e||n)(u(de),u(x),u(R),u(je))};static \u0275cmp=M({type:n,selectors:[["app-detalle-ruta"]],decls:41,vars:8,consts:[[1,"detalle-ruta"],[1,"btn-volver",3,"click"],[1,"base"],[1,"btn-agregar",3,"click"],[1,"filtro-dia"],[3,"ngModelChange","change","ngModel"],["value","todos"],["value","lunes"],["value","martes"],["value","miercoles"],["value","jueves"],["value","viernes"],["value","sabado"],["value","domingo"],["value","festivos"],[1,"btn-reparto",3,"click"],["class","loading",4,"ngIf"],["class","lista",4,"ngIf"],["class","sin-datos",4,"ngIf"],["class","modal-fondo",4,"ngIf"],[1,"loading"],[1,"lista"],["class","card",3,"click",4,"ngFor","ngForOf"],[1,"card",3,"click"],[1,"cliente"],[1,"direccion"],[1,"info"],[1,"sin-datos"],[1,"modal-fondo"],[1,"modal-contenido"],[4,"ngIf"],[1,"acciones-modal"],[1,"btn-maps",3,"click"],[1,"btn-editar",3,"click"],[1,"btn-cerrar",3,"click"]],template:function(e,i){if(e&1&&(s(0,"div",0)(1,"button",1),f("click",function(){return i.volver()}),l(2,"\u2B05 Volver"),a(),s(3,"h1"),l(4),a(),s(5,"p",2),l(6,"Zona base: "),s(7,"strong"),l(8),a()(),s(9,"button",3),f("click",function(){return i.agregarDireccion()}),l(10," \u2795 Agregar direcci\xF3n "),a(),s(11,"div",4)(12,"label"),l(13,"D\xEDa de reparto: "),s(14,"select",5),m("ngModelChange",function(o){return h(i.diaSeleccionado,o)||(i.diaSeleccionado=o),o}),f("change",function(){return i.filtrarPorDia()}),s(15,"option",6),l(16,"Todos"),a(),s(17,"option",7),l(18,"Lunes"),a(),s(19,"option",8),l(20,"Martes"),a(),s(21,"option",9),l(22,"Mi\xE9rcoles"),a(),s(23,"option",10),l(24,"Jueves"),a(),s(25,"option",11),l(26,"Viernes"),a(),s(27,"option",12),l(28,"S\xE1bado"),a(),s(29,"option",13),l(30,"Domingo"),a(),s(31,"option",14),l(32,"Festivos"),a()()()(),s(33,"button",15),f("click",function(){return i.iniciarReparto()}),l(34),a(),s(35,"h2"),l(36,"Direcciones cargadas"),a(),O(37,mi,2,0,"div",16)(38,fi,2,1,"div",17)(39,_i,2,0,"p",18)(40,Ai,34,14,"div",19),a()),e&2){let r,o;d(4),te((r=i.ruta())==null?null:r.nombrePersonalizado),d(4),te((o=i.ruta())==null?null:o.nombreBase),d(6),p("ngModel",i.diaSeleccionado),d(20),P(" \u{1F69A} ",i.hayProgresoGuardado()?"Continuar reparto":"Iniciar reparto",`
`),d(3),y("ngIf",i.cargandoDirecciones()),d(),y("ngIf",!i.cargandoDirecciones()&&i.direcciones().length>0),d(),y("ngIf",!i.cargandoDirecciones()&&i.direcciones().length===0),d(),y("ngIf",i.modalAbierto())}},dependencies:[I,We,le,X,Je,Xe,he,J,W],styles:['@charset "UTF-8";.detalle-ruta[_ngcontent-%COMP%]{max-width:600px;margin:20px auto;padding:0 15px;display:flex;flex-direction:column;gap:15px;font-family:Arial,sans-serif}h1[_ngcontent-%COMP%]{margin:0;font-size:26px}.base[_ngcontent-%COMP%]{color:#555}.btn-volver[_ngcontent-%COMP%], .btn-agregar[_ngcontent-%COMP%]{padding:10px 14px;border:none;background:#1976d2;color:#fff;border-radius:6px;cursor:pointer;width:fit-content}.btn-volver[_ngcontent-%COMP%]{background:#555}.btn-agregar[_ngcontent-%COMP%]{background:#2e7d32}.loading[_ngcontent-%COMP%]{font-size:14px;color:#777}.lista[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:12px}.card[_ngcontent-%COMP%]{background:#f1f1f1;padding:14px;border-radius:8px;cursor:pointer;transition:.15s ease;border:1px solid #ddd}.card[_ngcontent-%COMP%]:hover{background:#e9e9e9}.cliente[_ngcontent-%COMP%]{font-size:18px;font-weight:700}.direccion[_ngcontent-%COMP%]{color:#444;margin-top:4px}.info[_ngcontent-%COMP%]{margin-top:6px;font-size:14px;color:#666}.sin-datos[_ngcontent-%COMP%]{text-align:center;margin-top:20px;color:#777}.filtro-dia[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:8px}.filtro-dia[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{padding:6px;font-size:14px;border-radius:6px;border:1px solid #ccc}.modal-fondo[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100%;height:100%;background:#0000008c;display:flex;justify-content:center;align-items:center;z-index:999}.modal-contenido[_ngcontent-%COMP%]{background:#fff;width:90%;max-width:420px;padding:20px;border-radius:10px;animation:_ngcontent-%COMP%_fadeIn .2s ease}.acciones-modal[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:10px;margin-top:20px}.btn-editar[_ngcontent-%COMP%]{background:#4caf50;color:#fff;padding:10px;border-radius:6px;border:none;cursor:pointer;width:100%}.btn-cerrar[_ngcontent-%COMP%]{background:#aaa;color:#fff;padding:10px 14px;border:none;border-radius:6px;cursor:pointer}.btn-maps[_ngcontent-%COMP%]{background:#4285f4;color:#fff;padding:12px;border-radius:6px;border:none;cursor:pointer;margin-bottom:12px;text-align:center;width:100%}.btn-maps[_ngcontent-%COMP%]:hover{background:#3367d6}@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0;transform:scale(.95)}to{opacity:1;transform:scale(1)}}'],changeDetection:0})};var et=class n{constructor(t,e,i){this.route=t;this.router=e;this.rutasService=i}rutaId;cliente="";direccion="";cantidadDiarios=1;lat=null;lng=null;dias={lunes:!1,martes:!1,miercoles:!1,jueves:!1,viernes:!1,sabado:!1,domingo:!1,festivos:!1,guardarFinSemanaParaLunes:!1};notas="";ngOnInit(){this.rutaId=this.route.snapshot.params.id}async guardar(){if(!this.cliente.trim()||!this.direccion.trim()){alert("Completa cliente y direcci\xF3n");return}await this.rutasService.agregarDireccion(this.rutaId,{rutaId:this.rutaId,cliente:this.cliente,direccion:this.direccion,cantidadDiarios:this.cantidadDiarios,dias:this.dias,lat:this.lat,lng:this.lng,indiceOrden:9999,notas:this.notas}),alert("Direcci\xF3n agregada"),window.location.href=`/rutas/${this.rutaId}`}cancelar(){window.location.href=`/rutas/${this.rutaId}`}static \u0275fac=function(e){return new(e||n)(u(de),u(x),u(R))};static \u0275cmp=M({type:n,selectors:[["app-agregar-direccion"]],decls:55,vars:14,consts:[[1,"agregar"],["type","text",3,"ngModelChange","ngModel"],["type","number","min","1",3,"ngModelChange","ngModel"],[1,"dias"],["type","checkbox",3,"ngModelChange","ngModel"],["type","number","step","0.000001",3,"ngModelChange","ngModel"],[1,"acciones"],[3,"click"]],template:function(e,i){e&1&&(s(0,"div",0)(1,"h1"),l(2,"Nueva direcci\xF3n"),a(),s(3,"label"),l(4,"Cliente: "),s(5,"input",1),m("ngModelChange",function(o){return h(i.cliente,o)||(i.cliente=o),o}),a()(),s(6,"label"),l(7,"Direcci\xF3n: "),s(8,"input",1),m("ngModelChange",function(o){return h(i.direccion,o)||(i.direccion=o),o}),a()(),s(9,"label"),l(10,"Cantidad de diarios: "),s(11,"input",2),m("ngModelChange",function(o){return h(i.cantidadDiarios,o)||(i.cantidadDiarios=o),o}),a()(),s(12,"h3"),l(13,"D\xEDas de entrega"),a(),s(14,"div",3)(15,"label")(16,"input",4),m("ngModelChange",function(o){return h(i.dias.lunes,o)||(i.dias.lunes=o),o}),a(),l(17," Lunes"),a(),s(18,"label")(19,"input",4),m("ngModelChange",function(o){return h(i.dias.martes,o)||(i.dias.martes=o),o}),a(),l(20," Martes"),a(),s(21,"label")(22,"input",4),m("ngModelChange",function(o){return h(i.dias.miercoles,o)||(i.dias.miercoles=o),o}),a(),l(23," Mi\xE9rcoles"),a(),s(24,"label")(25,"input",4),m("ngModelChange",function(o){return h(i.dias.jueves,o)||(i.dias.jueves=o),o}),a(),l(26," Jueves"),a(),s(27,"label")(28,"input",4),m("ngModelChange",function(o){return h(i.dias.viernes,o)||(i.dias.viernes=o),o}),a(),l(29," Viernes"),a(),s(30,"label")(31,"input",4),m("ngModelChange",function(o){return h(i.dias.sabado,o)||(i.dias.sabado=o),o}),a(),l(32," S\xE1bado"),a(),s(33,"label")(34,"input",4),m("ngModelChange",function(o){return h(i.dias.domingo,o)||(i.dias.domingo=o),o}),a(),l(35," Domingo"),a(),s(36,"label")(37,"input",4),m("ngModelChange",function(o){return h(i.dias.festivos,o)||(i.dias.festivos=o),o}),a(),l(38," Festivos"),a(),s(39,"label")(40,"input",4),m("ngModelChange",function(o){return h(i.dias.guardarFinSemanaParaLunes,o)||(i.dias.guardarFinSemanaParaLunes=o),o}),a(),l(41," Guardar s\xE1b-dom para entregar el lunes"),a()(),s(42,"h3"),l(43,"Coordenadas"),a(),s(44,"label"),l(45,"Latitud: "),s(46,"input",5),m("ngModelChange",function(o){return h(i.lat,o)||(i.lat=o),o}),a()(),s(47,"label"),l(48,"Longitud: "),s(49,"input",5),m("ngModelChange",function(o){return h(i.lng,o)||(i.lng=o),o}),a()(),s(50,"div",6)(51,"button",7),f("click",function(){return i.guardar()}),l(52,"Guardar"),a(),s(53,"button",7),f("click",function(){return i.cancelar()}),l(54,"Cancelar"),a()()()),e&2&&(d(5),p("ngModel",i.cliente),d(3),p("ngModel",i.direccion),d(3),p("ngModel",i.cantidadDiarios),d(5),p("ngModel",i.dias.lunes),d(3),p("ngModel",i.dias.martes),d(3),p("ngModel",i.dias.miercoles),d(3),p("ngModel",i.dias.jueves),d(3),p("ngModel",i.dias.viernes),d(3),p("ngModel",i.dias.sabado),d(3),p("ngModel",i.dias.domingo),d(3),p("ngModel",i.dias.festivos),d(3),p("ngModel",i.dias.guardarFinSemanaParaLunes),d(6),p("ngModel",i.lat),d(3),p("ngModel",i.lng))},dependencies:[I,X,K,Se,Ve,J,xe,W],styles:[".agregar[_ngcontent-%COMP%]{max-width:500px;margin:20px auto;padding:20px}label[_ngcontent-%COMP%]{display:flex;flex-direction:column;margin:12px 0}input[_ngcontent-%COMP%]{padding:8px;border-radius:6px;border:1px solid #ccc}.acciones[_ngcontent-%COMP%]{display:flex;gap:10px;margin-top:20px}button[_ngcontent-%COMP%]{padding:10px;border-radius:5px;cursor:pointer}"]})};function Ii(n,t){n&1&&(s(0,"div"),l(1,"Cargando..."),a())}function Fi(n,t){if(n&1){let e=ee();s(0,"div")(1,"label"),l(2,"Cliente: "),s(3,"input",2),m("ngModelChange",function(r){_(e);let o=g();return h(o.direccion().cliente,r)||(o.direccion().cliente=r),v(r)}),a()(),s(4,"label"),l(5,"Direcci\xF3n: "),s(6,"input",2),m("ngModelChange",function(r){_(e);let o=g();return h(o.direccion().direccion,r)||(o.direccion().direccion=r),v(r)}),a()(),s(7,"label"),l(8,"Cantidad de diarios: "),s(9,"input",3),m("ngModelChange",function(r){_(e);let o=g();return h(o.direccion().cantidadDiarios,r)||(o.direccion().cantidadDiarios=r),v(r)}),a()(),s(10,"h3"),l(11,"D\xEDas de entrega"),a(),s(12,"div",4)(13,"label")(14,"input",5),m("ngModelChange",function(r){_(e);let o=g();return h(o.direccion().dias.lunes,r)||(o.direccion().dias.lunes=r),v(r)}),a(),l(15," Lunes"),a(),s(16,"label")(17,"input",5),m("ngModelChange",function(r){_(e);let o=g();return h(o.direccion().dias.martes,r)||(o.direccion().dias.martes=r),v(r)}),a(),l(18," Martes"),a(),s(19,"label")(20,"input",5),m("ngModelChange",function(r){_(e);let o=g();return h(o.direccion().dias.miercoles,r)||(o.direccion().dias.miercoles=r),v(r)}),a(),l(21," Mi\xE9rcoles"),a(),s(22,"label")(23,"input",5),m("ngModelChange",function(r){_(e);let o=g();return h(o.direccion().dias.jueves,r)||(o.direccion().dias.jueves=r),v(r)}),a(),l(24," Jueves"),a(),s(25,"label")(26,"input",5),m("ngModelChange",function(r){_(e);let o=g();return h(o.direccion().dias.viernes,r)||(o.direccion().dias.viernes=r),v(r)}),a(),l(27," Viernes"),a(),s(28,"label")(29,"input",5),m("ngModelChange",function(r){_(e);let o=g();return h(o.direccion().dias.sabado,r)||(o.direccion().dias.sabado=r),v(r)}),a(),l(30," S\xE1bado"),a(),s(31,"label")(32,"input",5),m("ngModelChange",function(r){_(e);let o=g();return h(o.direccion().dias.domingo,r)||(o.direccion().dias.domingo=r),v(r)}),a(),l(33," Domingo"),a(),s(34,"label")(35,"input",5),m("ngModelChange",function(r){_(e);let o=g();return h(o.direccion().dias.festivos,r)||(o.direccion().dias.festivos=r),v(r)}),a(),l(36," Festivos"),a(),s(37,"label")(38,"input",5),m("ngModelChange",function(r){_(e);let o=g();return h(o.direccion().dias.guardarFinSemanaParaLunes,r)||(o.direccion().dias.guardarFinSemanaParaLunes=r),v(r)}),a(),l(39," Guardar s\xE1b-dom para entregar lunes "),a()(),s(40,"h3"),l(41,"Coordenadas"),a(),s(42,"label"),l(43,"Latitud: "),s(44,"input",6),m("ngModelChange",function(r){_(e);let o=g();return h(o.direccion().lat,r)||(o.direccion().lat=r),v(r)}),a()(),s(45,"label"),l(46,"Longitud: "),s(47,"input",6),m("ngModelChange",function(r){_(e);let o=g();return h(o.direccion().lng,r)||(o.direccion().lng=r),v(r)}),a()(),s(48,"label"),l(49,"Notas: "),s(50,"textarea",7),m("ngModelChange",function(r){_(e);let o=g();return h(o.direccion().notas,r)||(o.direccion().notas=r),v(r)}),a()(),s(51,"div",8)(52,"button",9),f("click",function(){_(e);let r=g();return v(r.guardar())}),l(53,"Guardar cambios"),a(),s(54,"button",9),f("click",function(){_(e);let r=g();return v(r.cancelar())}),l(55,"Cancelar"),a()()()}if(n&2){let e=g();d(3),p("ngModel",e.direccion().cliente),d(3),p("ngModel",e.direccion().direccion),d(3),p("ngModel",e.direccion().cantidadDiarios),d(5),p("ngModel",e.direccion().dias.lunes),d(3),p("ngModel",e.direccion().dias.martes),d(3),p("ngModel",e.direccion().dias.miercoles),d(3),p("ngModel",e.direccion().dias.jueves),d(3),p("ngModel",e.direccion().dias.viernes),d(3),p("ngModel",e.direccion().dias.sabado),d(3),p("ngModel",e.direccion().dias.domingo),d(3),p("ngModel",e.direccion().dias.festivos),d(3),p("ngModel",e.direccion().dias.guardarFinSemanaParaLunes),d(6),p("ngModel",e.direccion().lat),d(3),p("ngModel",e.direccion().lng),d(3),p("ngModel",e.direccion().notas)}}var tt=class n{constructor(t,e,i){this.route=t;this.router=e;this.rutasService=i}rutaId;direccionId;direccion=b(null);cargando=b(!0);async ngOnInit(){this.rutaId=this.route.snapshot.params.rutaId,this.direccionId=this.route.snapshot.params.direccionId;let e=(await this.rutasService.obtenerDireccionesOrdenadas(this.rutaId)).find(i=>i.id===this.direccionId)||null;this.direccion.set(e),this.cargando.set(!1)}async guardar(){let t=this.direccion();t&&(await this.rutasService.actualizarDireccion(this.rutaId,this.direccionId,{cliente:t.cliente,direccion:t.direccion,cantidadDiarios:t.cantidadDiarios,dias:t.dias,lat:t.lat??null,lng:t.lng??null,notas:t.notas??""}),alert("Direcci\xF3n actualizada"),window.location.href=`/rutas/${this.rutaId}`)}cancelar(){window.location.href=`/rutas/${this.rutaId}`}static \u0275fac=function(e){return new(e||n)(u(de),u(x),u(R))};static \u0275cmp=M({type:n,selectors:[["app-editar-direccion"]],decls:5,vars:2,consts:[[1,"editar"],[4,"ngIf"],["type","text",3,"ngModelChange","ngModel"],["type","number","min","1",3,"ngModelChange","ngModel"],[1,"dias"],["type","checkbox",3,"ngModelChange","ngModel"],["type","number","step","0.000001",3,"ngModelChange","ngModel"],["rows","3",3,"ngModelChange","ngModel"],[1,"acciones"],[3,"click"]],template:function(e,i){e&1&&(s(0,"div",0)(1,"h1"),l(2,"Editar direcci\xF3n"),a(),O(3,Ii,2,0,"div",1)(4,Fi,56,15,"div",1),a()),e&2&&(d(3),y("ngIf",i.cargando()),d(),y("ngIf",!i.cargando()&&i.direccion()))},dependencies:[I,le,X,K,Se,Ve,J,xe,W],styles:['@charset "UTF-8";.editar[_ngcontent-%COMP%]{max-width:500px;margin:20px auto}label[_ngcontent-%COMP%]{display:flex;flex-direction:column;margin:12px 0}textarea[_ngcontent-%COMP%], input[type=text][_ngcontent-%COMP%], input[type=number][_ngcontent-%COMP%]{padding:8px;border-radius:6px;border:1px solid #ccc}.dias[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center;gap:8px;margin:5px 0}.dias[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]{transform:scale(1.2)}'],changeDetection:0})};var Dn=[{path:"login",component:Ue},{path:"dashboard",component:Ge,canActivate:[ie]},{path:"rutas",component:Be,canActivate:[ie]},{path:"rutas/crear",component:Qe,canActivate:[ie]},{path:"rutas/:id",component:$e,canActivate:[ie]},{path:"rutas/:id/agregar",component:et,canActivate:[ie]},{path:"rutas/:rutaId/editar/:direccionId",component:tt,canActivate:[ie]},{path:"rutas/:id/reparto",loadComponent:()=>import("./chunk-Q3FWU2BU.js").then(n=>n.RepartoComponent)},{path:"",redirectTo:"rutas",pathMatch:"full"},{path:"**",redirectTo:"rutas"}];var Mn={production:!1,firebase:{apiKey:"AIzaSyC1JRiX866tj1XMPOyu400_3iEA02C2tQY",authDomain:"db-reparto.firebaseapp.com",projectId:"db-reparto",storageBucket:"db-reparto.firebasestorage.app",messagingSenderId:"215008209680",appId:"1:215008209680:web:e06909281a34284fe79395"}};var yt="Service workers are disabled or not supported by this browser",me=class{serviceWorker;worker;registration;events;constructor(t,e){if(this.serviceWorker=t,!t)this.worker=this.events=this.registration=new Ie(i=>i.error(new L(5601,!1)));else{let i=null,r=new oe;this.worker=new Ie(D=>(i!==null&&D.next(i),r.subscribe(j=>D.next(j))));let o=()=>{let{controller:D}=t;D!==null&&(i=D,r.next(i))};t.addEventListener("controllerchange",o),o(),this.registration=this.worker.pipe(ge(()=>t.getRegistration().then(D=>{if(!D)throw new L(5601,!1);return D})));let c=new oe;this.events=c.asObservable();let C=D=>{let{data:j}=D;j?.type&&c.next(j)};t.addEventListener("message",C),e?.get(ve,null,{optional:!0})?.onDestroy(()=>{t.removeEventListener("controllerchange",o),t.removeEventListener("message",C)})}}postMessage(t,e){return new Promise(i=>{this.worker.pipe(ae(1)).subscribe(r=>{r.postMessage(A({action:t},e)),i()})})}postMessageWithOperation(t,e,i){let r=this.waitForOperationCompleted(i),o=this.postMessage(t,e);return Promise.all([o,r]).then(([,c])=>c)}generateNonce(){return Math.round(Math.random()*1e7)}eventsOfType(t){let e;return typeof t=="string"?e=i=>i.type===t:e=i=>t.includes(i.type),this.events.pipe(lt(e))}nextEventOfType(t){return this.eventsOfType(t).pipe(ae(1))}waitForOperationCompleted(t){return new Promise((e,i)=>{this.eventsOfType("OPERATION_COMPLETED").pipe(lt(r=>r.nonce===t),ae(1),F(r=>{if(r.result!==void 0)return r.result;throw new Error(r.error)})).subscribe({next:e,error:i})})}get isEnabled(){return!!this.serviceWorker}},Oi=(()=>{class n{sw;messages;notificationClicks;notificationCloses;pushSubscriptionChanges;subscription;get isEnabled(){return this.sw.isEnabled}pushManager=null;subscriptionChanges=new oe;constructor(e){if(this.sw=e,!e.isEnabled){this.messages=B,this.notificationClicks=B,this.notificationCloses=B,this.pushSubscriptionChanges=B,this.subscription=B;return}this.messages=this.sw.eventsOfType("PUSH").pipe(F(r=>r.data)),this.notificationClicks=this.sw.eventsOfType("NOTIFICATION_CLICK").pipe(F(r=>r.data)),this.notificationCloses=this.sw.eventsOfType("NOTIFICATION_CLOSE").pipe(F(r=>r.data)),this.pushSubscriptionChanges=this.sw.eventsOfType("PUSH_SUBSCRIPTION_CHANGE").pipe(F(r=>r.data)),this.pushManager=this.sw.registration.pipe(F(r=>r.pushManager));let i=this.pushManager.pipe(ge(r=>r.getSubscription()));this.subscription=new Ie(r=>{let o=i.subscribe(r),c=this.subscriptionChanges.subscribe(r);return()=>{o.unsubscribe(),c.unsubscribe()}})}requestSubscription(e){if(!this.sw.isEnabled||this.pushManager===null)return Promise.reject(new Error(yt));let i={userVisibleOnly:!0},r=this.decodeBase64(e.serverPublicKey.replace(/_/g,"/").replace(/-/g,"+")),o=new Uint8Array(new ArrayBuffer(r.length));for(let c=0;c<r.length;c++)o[c]=r.charCodeAt(c);return i.applicationServerKey=o,new Promise((c,C)=>{this.pushManager.pipe(ge(w=>w.subscribe(i)),ae(1)).subscribe({next:w=>{this.subscriptionChanges.next(w),c(w)},error:C})})}unsubscribe(){if(!this.sw.isEnabled)return Promise.reject(new Error(yt));let e=i=>{if(i===null)throw new L(5602,!1);return i.unsubscribe().then(r=>{if(!r)throw new L(5603,!1);this.subscriptionChanges.next(null)})};return new Promise((i,r)=>{this.subscription.pipe(ae(1),ge(e)).subscribe({next:i,error:r})})}decodeBase64(e){return atob(e)}static \u0275fac=function(i){return new(i||n)(Y(me))};static \u0275prov=se({token:n,factory:n.\u0275fac})}return n})(),Pi=(()=>{class n{sw;versionUpdates;unrecoverable;get isEnabled(){return this.sw.isEnabled}ongoingCheckForUpdate=null;constructor(e){if(this.sw=e,!e.isEnabled){this.versionUpdates=B,this.unrecoverable=B;return}this.versionUpdates=this.sw.eventsOfType(["VERSION_DETECTED","VERSION_INSTALLATION_FAILED","VERSION_READY","NO_NEW_VERSION_DETECTED"]),this.unrecoverable=this.sw.eventsOfType("UNRECOVERABLE_STATE")}checkForUpdate(){if(!this.sw.isEnabled)return Promise.reject(new Error(yt));if(this.ongoingCheckForUpdate)return this.ongoingCheckForUpdate;let e=this.sw.generateNonce();return this.ongoingCheckForUpdate=this.sw.postMessageWithOperation("CHECK_FOR_UPDATES",{nonce:e},e).finally(()=>{this.ongoingCheckForUpdate=null}),this.ongoingCheckForUpdate}activateUpdate(){if(!this.sw.isEnabled)return Promise.reject(new L(5601,!1));let e=this.sw.generateNonce();return this.sw.postMessageWithOperation("ACTIVATE_UPDATE",{nonce:e},e)}static \u0275fac=function(i){return new(i||n)(Y(me))};static \u0275prov=se({token:n,factory:n.\u0275fac})}return n})(),En=new U("");function Ni(){let n=V(Ae);if(!("serviceWorker"in navigator&&n.enabled!==!1))return;let t=V(En),e=V(Vt),i=V(ve);e.runOutsideAngular(()=>{let r=navigator.serviceWorker,o=()=>r.controller?.postMessage({action:"INITIALIZE"});r.addEventListener("controllerchange",o),i.onDestroy(()=>{r.removeEventListener("controllerchange",o)})}),e.runOutsideAngular(()=>{let r,{registrationStrategy:o}=n;if(typeof o=="function")r=new Promise(c=>o().subscribe(()=>c()));else{let[c,...C]=(o||"registerWhenStable:30000").split(":");switch(c){case"registerImmediately":r=Promise.resolve();break;case"registerWithDelay":r=wn(+C[0]||0);break;case"registerWhenStable":r=Promise.race([i.whenStable(),wn(+C[0])]);break;default:throw new L(5600,!1)}}r.then(()=>{i.destroyed||navigator.serviceWorker.register(t,{scope:n.scope,updateViaCache:n.updateViaCache,type:n.type}).catch(c=>console.error(Mt(5604,!1)))})})}function wn(n){return new Promise(t=>setTimeout(t,n))}function Ri(){let n=V(Ae),t=V(dt),e=!0;return new me(e&&n.enabled!==!1?navigator.serviceWorker:void 0,t)}var Ae=class{enabled;updateViaCache;type;scope;registrationStrategy};function nt(n,t={}){return wt([Oi,Pi,{provide:En,useValue:n},{provide:Ae,useValue:t},{provide:me,useFactory:Ri},At(Ni)])}var Vn={providers:[Rt(Dn),kt(()=>Tt(Mn.firebase)),jt(()=>Lt()),zt(()=>Kt()),nt("ngsw-worker.js",{enabled:!Te(),registrationStrategy:"registerWhenStable:30000"}),nt("ngsw-worker.js",{enabled:!Te(),registrationStrategy:"registerWhenStable:30000"}),nt("ngsw-worker.js",{enabled:!Te(),registrationStrategy:"registerWhenStable:30000"})]};var it=class n{title=b("DB-reparto");static \u0275fac=function(e){return new(e||n)};static \u0275cmp=M({type:n,selectors:[["app-root"]],decls:1,vars:0,template:function(e,i){e&1&&Ne(0,"router-outlet")},dependencies:[Nt],encapsulation:2})};Pt(it,Vn).catch(n=>console.error(n));
